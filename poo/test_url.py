'''
file -- table_to_dataframe.py -- 
'''

#Liberias necesarias
import requests 
from bs4 import BeautifulSoup as bs
import json
import re
import pandas as pd

links = '<tr><td><a href="https://www.misprofesores.com/escuelas/UANL-Facultad-de-Derecho-y-Criminologia_2323"><b>UANL Facultad de Derecho y Criminología</b></a></td><td>San Nicolás de los Garza </td><td>Nuevo León </td><td>89</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL-PREPARATORIA-15-MADERO_5297"><b>UANL PREPARATORIA 15 MADERO</b></a></td><td>Momterrey</td><td>Nuevo León </td><td>6</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Facultad-de-Ciencias-Politicas-y-Admon-Pub-UANL_2277"><b>Facultad de Ciencias Politicas y Admon Pub UANL</b></a></td><td>mty</td><td>Nuevo Leon</td><td>64</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL-Facultad-de-Medicina-Veterinaria-y-Zootecnia_5201"><b>UANL Facultad de Medicina Veterinaria y Zootecnia</b></a></td><td>Monterrey</td><td>NL</td><td>2</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/uanl-facultad-de-ciencias-quimicas_2274"><b>uanl facultad de ciencias quimicas</b></a></td><td>mty</td><td>nuevo leon</td><td>12</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Facultad-de-Arquitectura-y-Diseno-Industrial-UANL_5172"><b>Facultad de Arquitectura y Diseño Industrial UANL</b></a></td><td>Monterrey</td><td>Nuevo León</td><td>8</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL-FCT_2269"><b>UANL (FCT)</b></a></td><td>linares</td><td>Nuevo león</td><td>8</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Preparatoria-No-23-UANL_5148"><b>Preparatoria No. 23 UANL</b></a></td><td>Santa Catarina </td><td>Nuevo León </td><td>8</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL_11792"><b>UANL</b></a></td><td>Sanicolas</td><td>NUEVO LEON</td><td>0</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Facultad-de-Ciencias-FisicoMatematicas-UANL_2267"><b>Facultad de Ciencias Fisico-Matematicas UANL</b></a></td><td>San Nicolas de los Garza</td><td>Nuevo Leon</td><td>22</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Facultad-de-ciencias-de-la-tierra-UANL_5147"><b>Facultad de ciencias de la tierra UANL</b></a></td><td>Linares</td><td>Nuevo León </td><td>13</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/FARQ-UANL_11314"><b>FARQ UANL</b></a></td><td>SAN NICOLAS</td><td>NL</td><td>0</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL-FCFM_2263"><b>UANL- FCFM</b></a></td><td>San Nicolás de los Garza</td><td>Nuevo León</td><td>522</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/uanl_5108"><b>uanl</b></a></td><td></td><td></td><td>0</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL-PREPARATORIA-15-FLORIDA_11287"><b>UANL PREPARATORIA 15 FLORIDA</b></a></td><td>MONTERREY</td><td>NUEVO LEÓN</td><td>3</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Facultad-de-Medicina-Veterinaria-y-Zootecnia-UANL_2014"><b>Facultad de Medicina Veterinaria y Zootecnia UANL</b></a></td><td>Monterrey</td><td>Nuevo León</td><td>23</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL-AGRONOMIA_5102"><b>UANL AGRONOMIA</b></a></td><td>General Escobedo</td><td>NUEVO LEON</td><td>0</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL-FIME_10892"><b>UANL FIME</b></a></td><td>Guadalupe</td><td>nuevo leon</td><td>0</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Facultad-de-Agronomia-UANL_1972"><b>Facultad de Agronomía UANL</b></a></td><td>Escobedo</td><td>Nuevo León</td><td>5</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Facultad-de-Ciencias-de-la-Comunicacion-UANL_4968"><b>Facultad de Ciencias de la Comunicación | UANL</b></a></td><td>Monterrey</td><td>Nuevo León</td><td>4</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL-FACDyC_10826"><b>UANL FACDyC</b></a></td><td>San Nicolás de los Garza</td><td>Nuevo León</td><td>0</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL_1760"><b>UANL</b></a></td><td>Monterrey </td><td>Nuevo León </td><td>71</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/uanl-preparatoria-9_4946"><b>uanl preparatoria 9</b></a></td><td>monterrey</td><td>nuevo leon</td><td>11</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Preparatoria-No-7-Puentes-UANL_10802"><b>Preparatoria No 7 Puentes UANL</b></a></td><td>San Nicolás de los Garza</td><td>Nuevo León</td><td>21</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Facultad-de-Psicologia-UANL_1643"><b>Facultad de Psicologia UANL</b></a></td><td>Monterrey</td><td>Nuevo Leon</td><td>65</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Facultad-de-Artes-Escenicas-UANL_4686"><b>Facultad de Artes Escenicas UANL</b></a></td><td>Monterrey</td><td>NL</td><td>3</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/preparatoria-6-uanl_10660"><b>preparatoria 6 uanl</b></a></td><td>montemorelos</td><td>nuevo leon</td><td>1</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL_1602"><b>UANL</b></a></td><td>Monterrey</td><td>Nuevo Leon</td><td>0</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/FACULTAD-DE-CIENCIAS-FORESTALES-UANL_4628"><b>FACULTAD DE CIENCIAS FORESTALES UANL</b></a></td><td>Linares</td><td>Nuevo León</td><td>2</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Uanl_10582"><b>Uanl</b></a></td><td>San nicolas</td><td>Nl</td><td>0</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL-Faculta-de-Ciencias-Biologicas_1537"><b>UANL - Faculta de Ciencias Biologicas</b></a></td><td>Monterrey</td><td>Nuevo Leon</td><td>89</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/uanleyptm_4618"><b>uanl-eyptm</b></a></td><td>monterrey</td><td>nuevo leon</td><td>2</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL_10499"><b>UANL</b></a></td><td>San Nicolás de los Garza</td><td>NUEVO LEÓN</td><td>0</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/uanl-filosofia-y-letras_1487"><b>uanl filosofia y letras</b></a></td><td>monterrey</td><td>nuevo leon</td><td>195</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Facultad-de-Artes-Visuales-UANL_4323"><b>Facultad de Artes Visuales UANL</b></a></td><td>Monterrey</td><td>Nuevo León</td><td>4</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL-PREPA-10_10374"><b>UANL PREPA 10</b></a></td><td>DOCTOR ARROYO</td><td>NUEVO LEON</td><td>1</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL-Facultad-de-Ingenieria-Mecanica-yElectrica_1482"><b>UANL - Facultad de Ingeniería Mecanica yElectrica</b></a></td><td>Monterrey</td><td>Nuevo León</td><td>18</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/uanl_4145"><b>uanl</b></a></td><td>monterrey</td><td>nuevo leon</td><td>1</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/uanl_10137"><b>uanl</b></a></td><td>apodaca</td><td>nuevo leon</td><td>0</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL-Facultad-de-Medicina_1448"><b>UANL (Facultad de Medicina)</b></a></td><td>Monterrey</td><td>Nuevo Leon</td><td>172</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Preparatoria-N-22-UANL_4099"><b>Preparatoria N° 22 UANL</b></a></td><td>Monterrey</td><td>Nuevo León </td><td>82</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Preparatoria-numero-8-UANL_9549"><b>Preparatoria número 8 UANL</b></a></td><td>Guadalupe </td><td>Nuevo leon</td><td>1</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL-Preparatoria-2_1362"><b>UANL - Preparatoria 2</b></a></td><td>Monterrey</td><td>Nuevo León</td><td>18</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL_4033"><b>UANL</b></a></td><td>San Nicolas</td><td>Nuevo León</td><td>2</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Facultad-de-ciencias-politicas-departamento-de-idiomas-UANL_9203"><b>Facultad de ciencias politicas departamento de idiomas UANL</b></a></td><td>Monterrey</td><td>Nuevo leon</td><td>4</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL-Facultad-de-Odontologia_1555"><b>UANL Facultad de Odontologia</b></a></td><td>Monterrey</td><td>Nuevo Leon</td><td>85</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/FAMUS-UANL_3937"><b>FAMUS UANL</b></a></td><td>Monterrey</td><td>Nuevo Leòn</td><td>1</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Preparatoria-17-uanl_9191"><b>Preparatoria 17 uanl</b></a></td><td>Monterrey</td><td>Nuevo Léon</td><td>1</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL-PREPARATORIA-22_3913"><b>UANL PREPARATORIA 22</b></a></td><td>Guadalupe</td><td>Nuevo León</td><td>26</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Preparatoria-20-Uanl_8266"><b>Preparatoria 20 Uanl</b></a></td><td>Santiago</td><td>Nuevo León </td><td>1</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/FACULTAD-DE-MUSICA-UANL_3769"><b>FACULTAD DE MÚSICA UANL</b></a></td><td>Monterrey</td><td>Nuevo León</td><td>65</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Preparatoria-3-uanl_6896"><b>Preparatoria #3 uanl</b></a></td><td>monterrey</td><td>Nuevo leon</td><td>2</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/facultad-de-medicina-UANL_3766"><b>facultad de medicina UANL</b></a></td><td>sanicolas</td><td>nuevo leon</td><td>1</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL-Facultad-de-Organizacion-Deportiva_6637"><b>UANL. Facultad de Organización Deportiva</b></a></td><td>Cd. Universitaria </td><td>Nuevo León </td><td>1</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/exci-uanl_3742"><b>exci uanl</b></a></td><td>san nicolas</td><td>nuevo leon</td><td>1</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Preparatoria-7-Oriente-UANL_6601"><b>Preparatoria 7 Oriente UANL</b></a></td><td>San Nicolás</td><td>Nuevo Leon</td><td>17</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANLFACDYC_3602"><b>UANL.FACDYC</b></a></td><td>Cd. UNIVERSITARIA , SAN NICOLAS DEW LOS GARZA ,N,L</td><td>NUEVO LEON</td><td>11</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Facultad-de-Ciencias-Quimicas-UANL_6549"><b>Facultad de Ciencias Químicas UANL</b></a></td><td>San Nicolás</td><td>Nuevo León</td><td>1</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Facultad-de-Ciencias-de-la-Comunicacion-UANL_3312"><b>Facultad de Ciencias de la Comunicación. UANL</b></a></td><td>Monterrey</td><td>NL</td><td>100</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/uanl-filosofia_6400"><b>uanl filosofia</b></a></td><td>San Nicolas</td><td>Nuevo Leon</td><td>0</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Facultad-de-Agronomia-UANL_3299"><b>Facultad de Agronomía (UANL)</b></a></td><td>Escobedo</td><td>Nuevo León</td><td>14</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL-Facultad-de-Economia_6288"><b>UANL Facultad de Economía</b></a></td><td>Monterrey</td><td>Nuevo León</td><td>2</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/FACPYAP-UANL_3228"><b>FACPYAP UANL</b></a></td><td>monterrey</td><td>nuevo leon</td><td>7</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Preparatoria-8-uanl_6105"><b>Preparatoria 8 uanl</b></a></td><td>Guadalupe</td><td>Nuevo leon</td><td>12</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL-ARTES-VISUALES_3194"><b>UANL ARTES VISUALES</b></a></td><td>Monterrey</td><td>NUEVO LEON</td><td>14</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL_5994"><b>UANL</b></a></td><td>MTY</td><td>NUEVO LEÓN</td><td>1</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL_3191"><b>UANL</b></a></td><td>Monterrey</td><td>Nuevo Leó</td><td>0</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL-Facultad-de-medicina_5759"><b>UANL Facultad de medicina</b></a></td><td>Monterrey</td><td>Nuevo León</td><td>1</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Facultad-de-Ingenieria-Civil-UANL_2888"><b>Facultad de Ingenieria Civil UANL</b></a></td><td>Monterrey</td><td>Nuevo Leon</td><td>111</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL_5550"><b>UANL</b></a></td><td>Monterrey</td><td></td><td>0</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/FARQ-UANL_2628"><b>FARQ. UANL</b></a></td><td>SAN NICOLAS</td><td>NUEVO LEON</td><td>485</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL_5539"><b>UANL</b></a></td><td>San Nicolás de los garzas </td><td>Nuevo León </td><td>1</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/FASPYN-UANL_2517"><b>FASPYN UANL</b></a></td><td>Monterrey </td><td>Nuevo León</td><td>70</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Facultad-de-Enfermeria-UANL_5394"><b>Facultad de Enfermería, UANL</b></a></td><td>Monterrey</td><td>Nuevo León </td><td>1</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Facultad-de-Medicina-UANL_2374"><b>Facultad de Medicina UANL</b></a></td><td>Monterrey</td><td>Nuevo Leon</td><td>46</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Facultad-de-Ciencias-Quimicas-UANL_5378"><b>Facultad de Ciencias Químicas UANL</b></a></td><td>Monterrey</td><td>NL</td><td>49</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/UANL-FACPYA_2373"><b>UANL - FACPYA</b></a></td><td>San Nicolás De Los Garza</td><td>Nuevo Leon</td><td>734</td></tr><tr><td><a href="https://www.misprofesores.com/escuelas/Facultad-de-Medicina-y-Hospital-Universitario-UANL_5357"><b>Facultad de Medicina y Hospital Universitario, UANL</b></a></td><td>Monterrey </td><td>Nuevo León</td><td>1</td></tr>'

urls = re.findall(r'"(.+?)"',links)

#Clases
class website: 

    site_name = "Mis Profesores"
    def __init__(self, apartado, URL):
        self.section = apartado
        self.URL = URL

#Programa principal
def to_dataframe(cadena):

    URL_site = cadena
    site = website("table", URL_site)
    
    html = requests.get(site.URL, verify = True)
    soup = bs(html.content, "html.parser")

    raw_json = raw_json = soup.find_all('script', type = 'text/javascript')
    str_json = "[" + re.search(r'{"i.*":\s*"(.*?)"}', str(raw_json)).group() + "]"
    str_to_json = json.loads(str_json)
    
    df = pd.json_normalize(str_to_json)

    print(df)

if __name__ == "__main__":
    
    for i in urls:
        to_dataframe(i)